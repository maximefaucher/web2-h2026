# Les formulaires `<form>` HTML5

## 1. Structure de base

```html
<form action="/traitement" method="POST">
  
  <label for="username">Nom</label>
  <input type="text" id="username" name="username" required>

  <button type="submit">Envoyer</button>

</form>
```

## 2. √âl√©ments principaux

|√âl√©ment|R√¥le|Notes|
|---|---|---|
|`<form>`|Conteneur|G√®re l'envoi|
|`<input>`|Champ polyvalent|Plusieurs `type`|
|`<select>`|Liste d√©roulante|Peut √™tre `multiple`|
|`<textarea>`|Texte multiligne|Pas de `type`|
|`<button>`|Bouton|`submit`, `reset`, `button`|
|`<label>`|√âtiquette|Associer avec `for`|
|`<datalist>`|Suggestions|Utilis√© avec `list`|

## 3. Types importants de pour l'√©l√©ment `<input>`

|Type|Utilisation|Validation native|
|---|---|---|
|`text`|Texte|`minlength`, `pattern`|
|`email`|Courriel|Format automatique|
|`password`|Mot de passe|`minlength`|
|`number`|Nombre|`min`, `max`, `step`|
|`date`|Date|`min`, `max`|
|`checkbox`|Choix multiple|M√™me `name` possible|
|`radio`|Choix unique|M√™me `name` obligatoire|
|`file`|Fichier|`accept`|
|`range`|Curseur|`min`, `max`|

## 4. Attributs essentiels

### Attributs g√©n√©raux

|Attribut|R√¥le|
|---|---|
|`name`|Cl√© envoy√©e au serveur|
|`value`|Valeur du champ|
|`required`|Champ obligatoire|
|`disabled`|D√©sactiv√©|
|`readonly`|Lecture seule|
|`id`|Associer au `<label>`|

### Attributs de validation

|Attribut|S'applique √†|R√¥le|
|---|---|---|
|`required`|Tous|Emp√™che soumission|
|`minlength`|`input[type=text]`, `textarea`|Longueur min|
|`maxlength`|`input[type=text]`, `textarea`|Longueur max|
|`pattern`|`input[type=text]`, `email`|Regex|
|`min`|`input[type=number]`, `date`|Valeur min|
|`max`|`input[type=number]`, `date`|Valeur max|
|`step`|`input[type=number]`, `range`|Incr√©ment|
|`placeholder`|`input[type=text]`|Indice visuel|
|`list`|`input` (la plupart des types)|Lien vers `datalist`|
|`multiple`|`select`, `file`|S√©lection multiple|

## 5. Validation JavaScript

> **M√©thode** :  
Intercepter l'√©v√©nement `submit` du `<form>`, puis appliquer la recette ci dessous :

```js
// Cibler les √©l√©ments
const form = document.querySelector("form");

// Fonction de rappel (callback) pour la validation
const validerFormulaire = (e) => {
  e.preventDefault(); // 1. Bloquer l'envoi (n√©cessaire)
  // 2. Validations personnalis√©es ici
  // 3. Validations natives ici
  // 4. Envoi si tout est ok!
};

// Ex√©cuter le callback lors de l'√©v√©nement submit
form.addEventListener("submit", validerFormulaire);
```

## 6. La `Constraint Validation API`

L'[API de validation des contraintes](https://developer.mozilla.org/fr/docs/Web/HTML/Guides/Constraint_validation) a √©t√© introduite avec HTML5 pour simplifier la t√¢che de validation des formulaires.

**Utiliser cette API** dans la conception et le traitement des formulaires **permet de r√©duire le travail n√©cessaire** pour assurer une **conformit√© des valeurs avec les contraintes souhait√©es**.

### M√©thodes importantes

|M√©thode/Propri√©t√©|R√¥le|
|---|---|
|`checkValidity()`|Retourne true/false|
|`reportValidity()`|Affiche messages natifs|
|`setCustomValidity(msg)`|Message personnalis√©|
|`validity`|D√©tails des erreurs|

### Exemple complet

```html
<form id="monForm">
  <input type="text"
         id="username"
         name="username"
         required
         minlength="3"
         placeholder="Nom">
  <button type="submit">Envoyer</button>
</form>
```

```js
// Cibler les √©l√©ments
const form = document.getElementById("monForm");
const username = document.getElementById("username");

// Fonction de rappel (callback) pour la validation
const validerFormulaire = (e) => {
  e.preventDefault(); // 1. Bloquer l'envoi (n√©cessaire)

  // 2. Validations personnalis√©es ici
  if (username.value === "admin") {
    username.setCustomValidity("Nom r√©serv√©.");
  } else {
    username.setCustomValidity(""); // IMPORTANT pour indiquer la validit√©
  }

  // 3. Validations natives ici
  if (!form.checkValidity()) {
    form.querySelectorAll(':invalid').forEach(elm => {console.log(elm.name, elm.validity)});
    form.reportValidity();
    return;
  }

  // 4. Envoi si tout est ok!
  console.log("Formulaire valide !");
};

// Ex√©cuter le callback lors de l'√©v√©nement submit
form.addEventListener("submit", validerFormulaire);
```

## 7. Objet `validity`

**La propri√©t√© `validity`** d'un √©l√©ment de formulaire **est un objet qui repr√©sente diff√©rentes fa√ßons selon lesquelles une valeur saisie peut √™tre invalide**. Utilis√© avec `setCustomValidity(msg)`, elle permet d'expliquer √† l'utilisateur la raison pour laquelle la valeur d'un champ est invalide.

|Propri√©t√©|Signification|
|---|---|
|`valueMissing`|Champ requis vide|
|`tooShort`|Trop court|
|`patternMismatch`|Regex invalide|
|`typeMismatch`|Email invalide|
|`rangeOverflow`|Trop grand|
|`rangeUnderflow`|Trop petit|
|`valid`|Tout est valide|

## üéØ √âL√âMENTS √Ä NE PAS OUBLIER

1. Toujours mettre un attribut `name` sur les champs
2. Associer `<label for="">`
3. Utiliser la validation HTML5 dans la mesure du possible
4. Intercepter l'√©v√©nement `submit`
5. Remettre les validations personnalis√©es avec `setCustomValidity("")`

## üß† R√©sum√© mental

HTML valide ‚Üí JS intercepte ‚Üí `checkValidity()` ‚Üí `reportValidity()` ‚Üí OK ‚Üí envoyer
